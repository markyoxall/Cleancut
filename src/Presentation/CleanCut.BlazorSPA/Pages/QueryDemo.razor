@page "/customers/search"
@inject NavigationManager Navigation

<h3>Customer search (query example)</h3>

<input class="form-control mb-2" @bind="search" placeholder="search term" />
<button class="btn btn-primary mb-2" @onclick="DoSearch">Search</button>

@if (!string.IsNullOrEmpty(search))
{
    <p>Searching for: <strong>@search</strong></p>
}

@code {
    private string? search;

    protected override void OnInitialized()
    {
        var uri = new Uri(Navigation.Uri);
        var q = System.Web.HttpUtility.ParseQueryString(uri.Query).Get("q");
        if (!string.IsNullOrEmpty(q))
        {
            search = q;
        }
    }

    private void DoSearch()
    {
        var uri = new Uri(Navigation.Uri);
        var baseUri = uri.GetLeftPart(UriPartial.Path);
        var newUri = baseUri + "?q=" + System.Uri.EscapeDataString(search ?? string.Empty);
        Navigation.NavigateTo(newUri);
    }
}
