@page "/customers/edit/{Id:guid?}"
@using CleanCut.BlazorSPA.Pages
@using CleanCut.BlazorSPA.Pages.Models
@using CleanCut.BlazorSPA.Pages.Validation
@using Microsoft.AspNetCore.Components.Forms
@using Blazored.FluentValidation

<PageTitle>Customer edit</PageTitle>

<h3>@(IsEditMode ? "Edit Customer" : "Create customer")</h3>

<EditForm EditContext="_editContext" OnValidSubmit="OnValidSubmitAsync">
    <FluentValidationValidator />
    <ValidationSummary />

    <div class="row">
        <div class="col-md-6">
            <div class="mb-3">
                <label class="form-label">First name</label>
                <InputText class="@($"form-control {GetFieldCss(nameof(Model.FirstName))}")" @bind-Value="Model.FirstName" />
                <ValidationMessage For="() => Model.FirstName" />
            </div>

            <div class="mb-3">
                <label class="form-label">Last name</label>
                <InputText class="@($"form-control {GetFieldCss(nameof(Model.LastName))}")" @bind-Value="Model.LastName" />
                <ValidationMessage For="() => Model.LastName" />
            </div>

            <div class="mb-3">
                <label class="form-label">Email</label>
                <InputText class="@($"form-control {GetFieldCss(nameof(Model.Email))}")" @bind-Value="Model.Email" type="email" />
                <ValidationMessage For="() => Model.Email" />
            </div>

            <div class="mb-3">
                <label class="form-label">Phone</label>
                <InputText class="@($"form-control {GetFieldCss(nameof(Model.PhoneNumber))}")" @bind-Value="Model.PhoneNumber" />
                <ValidationMessage For="() => Model.PhoneNumber" />
            </div>

            <div class="mb-3">
                <label class="form-label">Preferred contact method</label>
                <InputSelect class="form-select" @bind-Value="Model.PreferredContact">
                    <option value="ContactMethod.Unknown">-- choose --</option>
                    <option value="ContactMethod.Email">Email</option>
                    <option value="ContactMethod.Phone">Phone</option>
                    <option value="ContactMethod.SMS">SMS</option>
                </InputSelect>
            </div>

            <div class="mb-3">
                <label class="form-label">Gender</label>
                <InputSelect class="form-select" @bind-Value="Model.Gender">
                    <option value="Gender.Unknown">-- choose --</option>
                    <option value="Gender.Male">Male</option>
                    <option value="Gender.Female">Female</option>
                    <option value="Gender.Other">Other</option>
                </InputSelect>
            </div>

            <div class="mb-3">
                <label class="form-label">Country</label>
                <InputText class="@($"form-control {GetFieldCss(nameof(Model.Country))}")" @bind-Value="Model.Country" />
                <ValidationMessage For="() => Model.Country" />
            </div>

            <div class="mb-3">
                <label class="form-label">Favorite color</label>
                <InputText type="color" class="form-control form-control-color" @bind-Value="Model.FavoriteColor" />
            </div>

            <div class="mb-3">
                <label class="form-label">Notes</label>
                <InputTextArea class="@($"form-control {GetFieldCss(nameof(Model.Notes))}")" @bind-Value="Model.Notes" />
                <ValidationMessage For="() => Model.Notes" />
            </div>
        </div>

        <div class="col-md-6">
            <div class="mb-3">
                <label class="form-label">Age</label>
                <InputNumber class="@($"form-control {GetFieldCss(nameof(Model.Age))}")" @bind-Value="Model.Age" />
                <ValidationMessage For="() => Model.Age" />
            </div>

            <div class="mb-3">
                <label class="form-label">Birth date</label>
                <InputDate class="@($"form-control {GetFieldCss(nameof(Model.BirthDate))}")" @bind-Value="Model.BirthDate" />
                <ValidationMessage For="() => Model.BirthDate" />
            </div>

            <div class="mb-3">
                <label class="form-label">Member since</label>
                <InputDate class="form-control" @bind-Value="Model.MemberSince" />
            </div>

            <div class="mb-3">
                <label class="form-label">Last login (date/time)</label>
                <InputDate class="form-control" @bind-Value="Model.LastLogin" />
            </div>

            <div class="mb-3">
                <label class="form-label">Preferred contact time</label>
                <InputText type="time" class="@($"form-control {GetFieldCss(nameof(Model.PreferredContactTime))}")" @bind-Value="PreferredContactTimeString" />
                <ValidationMessage For="() => PreferredContactTimeString" />
            </div>

            <div class="mb-3">
                <label class="form-label">Balance</label>
                <InputNumber step="0.01" class="@($"form-control {GetFieldCss(nameof(Model.Balance))}")" @bind-Value="Model.Balance" />
                <ValidationMessage For="() => Model.Balance" />
            </div>

            <div class="mb-3">
                <label class="form-label">Rating</label>
                <InputNumber step="0.1" class="@($"form-control {GetFieldCss(nameof(Model.Rating))}")" @bind-Value="Model.Rating" />
                <ValidationMessage For="() => Model.Rating" />
            </div>

            <div class="mb-3 form-check">
                <InputCheckbox class="form-check-input" @bind-Value="Model.IsSubscribed" />
                <label class="form-check-label">Is subscribed</label>
            </div>

            <div class="mb-3 form-check">
                <InputCheckbox class="form-check-input" @bind-Value="Model.IsPremium" />
                <label class="form-check-label">Is premium</label>
            </div>

            <div class="mb-3">
                <label class="form-label">Website</label>
                <InputText class="@($"form-control {GetFieldCss(nameof(Model.Website))}")" @bind-Value="WebsiteString" />
                <ValidationMessage For="() => WebsiteString" />
            </div>

            <div class="mb-3">
                <label class="form-label">Upload</label>
                <InputFile OnChange="OnInputFileChange" />
                @if (!string.IsNullOrEmpty(Model.UploadedFileName))
                {
                    <div class="mt-2">Selected: @Model.UploadedFileName (@Model.UploadedFileSize bytes)</div>
                }
            </div>

            <div class="mb-3">
                <label class="form-label">Tags (comma separated)</label>
                <InputText class="@($"form-control {GetFieldCss(nameof(TagsCsv))}")" @bind-Value="TagsCsv" />
                <ValidationMessage For="() => TagsCsv" />
            </div>
        </div>
    </div>

    <div class="d-flex gap-2 mt-3">
        <button type="submit" class="btn btn-primary">Save</button>
        <a class="btn btn-secondary" href="/customerslist">Cancel</a>
    </div>
</EditForm>
